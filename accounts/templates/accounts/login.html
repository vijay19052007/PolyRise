{% extends 'base_auth.html' %}
{% load static %}
{% load form_tags %}

{% block title %}Login - PolyRise{% endblock %}

{% block content %}
<div class="login-wrapper d-flex align-items-center justify-content-center min-vh-100 px-3">
  <div class="login-card shadow p-4 rounded-4" style="width: 100%; max-width: 400px; background: white;">
    <div class="text-center mb-4">
      <img src="{% static 'images/logo.png' %}" alt="PolyRise Logo" style="height: 40px;" />
      <h4 class="mt-3">Welcome Back to PolyRise ðŸ‘‹</h4>
      <p class="text-muted small">Sign in to access your personalized dashboard</p>
    </div>

    <form method="POST" novalidate autocomplete="off">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <div class="mb-3">
        {{ form.role.label_tag }}
        {{ form.role|add_class:"form-select" }}
        {{ form.role.errors }}
      </div>

      <div class="mb-3" id="username-group">
        {{ form.username.label_tag }}
        {{ form.username|add_class:"form-control" }}
        {{ form.username.errors }}
      </div>

      <div class="mb-3">
        {{ form.password.label_tag }}
        {{ form.password|add_class:"form-control" }}
        {{ form.password.errors }}
      </div>

      <!-- Added Remember Me checkbox -->
      <div class="form-check mb-3">
        <input type="checkbox" class="form-check-input" id="remember_me" name="remember_me" />
        <label class="form-check-label" for="remember_me">Remember Me</label>
      </div>

      <div class="d-grid">
        <button type="submit" class="btn btn-primary">Login</button>
      </div>
    </form>

    <p class="mt-3 text-center">
      Don't have an account?
      <a href="{% url 'signup' %}">Create one</a>
    </p>
  </div>
</div>

<script>
  const roleSelect = document.getElementById("id_role");
  const usernameGroup = document.getElementById("username-group");

  function toggleUsername() {
    const usernameLabel = document.querySelector("label[for='id_username']");
    if (roleSelect && roleSelect.value === "admin") {
      usernameLabel.innerText = "Username or Email";
    } else {
      usernameLabel.innerText = "Email";
    }
  }

  if (roleSelect) {
    roleSelect.addEventListener("change", toggleUsername);
    window.addEventListener("DOMContentLoaded", toggleUsername);
  }
</script>
{% endblock %}
